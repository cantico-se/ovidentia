<!--#begin maclgroups --> 

<form method="post" action="{ babPhpSelf }">
<input type="hidden" name="tg" value="{ target }">
<input type="hidden" name="idx" value="{ index }">
<input type="hidden" name="item" value="{ id }">
<input type="hidden" name="table" value="">
<input type="hidden" name="what" value="">
<input type="hidden" name="{ return }" value="update">

<table  width="30%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr> 
	<td class="BabLoginCadreBackground" align="center" valign="middle"> 
		<table  width="100%" border="0" cellspacing="0" cellpadding="6" align="center">
		<!--#if multiple -->
		<tr>
			<td class="BabLoginMenuBackground">
			<table  width="100%" border="0" cellspacing="0" cellpadding="2" align="center">
				<!--#in getnexttable -->
				<tr>
					<td align="center" style="cursor:pointer ; cursor:hand;" id="macl_link_table_{ table }" onclick="macl_switch_view_on('{ table }')">
					{ title }
					</td>
				</tr>
				<!--#endin getnexttable -->
			</table>
			</td>
		</tr>
		<!--#endif multiple -->
		<!--#in getnexttable -->
		<tr id="macl_tr_table_{ table }"> 
			   <td class="BabLoginMenuBackground" align="center" nowrap valign="middle">
					<select name="macl_what_{ table }" id="macl_what_{ table }" onChange="macl_lock('macl_what_{ table }','macl_groups_{ table }');" >
						<!--#if listgroups --><option value="">{ listgroups }</option><!--#endif listgroups -->
						<!--#if disabled --><option value="-1" { what[disabled] }>{ disabled }</option><!--#endif disabled -->
						<!--#if everybody --><option value="0" { what[everybody] }>{ everybody }</option><!--#endif everybody -->
						<!--#if ballsite -->
						<!--#if users --><option value="1" { what[users] }>{ users }</option><!--#endif users -->
						<!--#if guests --><option value="2" { what[guests] }>{ guests }</option><!--#endif guests -->
						<!--#endif ballsite -->
				  </select> 
				 <!--#if listgroups -->
					  <div align="center" style="padding:0.5em">
					  { name }:
					  </div>
				 <select multiple name="macl_groups_{ table }[]" id="macl_groups_{ table }" size="10">
					<!--#in getnextgroup -->
					<option value="{ arrgroups[id] }" { arrgroups[select] }>{ arrgroups[name] }</option>
					<!--#endin getnextgroup -->
				</select>

			<!--#endif listgroups -->
			</td>
		</tr>
		<!--#endin getnexttable -->
		<tr valign="middle"> 
			<td class="BabLoginMenuBackground" align="center" valign="middle"> 
			<input type="submit" value="{ updategroups }">
			</td>
		</tr>
		</table>
	</td>
</tr>
</table>
</form>
<!--#end maclgroups -->



<!--#begin grp_maintree -->
<script type="text/javascript" src="{ babInstallPath }scripts/ul_tree.js"></script>

<script type="text/javascript">

function table_name(objname)
{
	if (objname.match(/\[(.*?)\]\[/i))
		return RegExp.$1;
}

function macl_switch_view_on(table)
{
	var menu = document.getElementById('bab_groups_acl').getElementsByTagName('li');
	for(var i = 0; i < menu.length; i++ )
		{
		menu[i].className = '';
		}
	
	if (null == table) {
		table = menu[0].id.substr(16);
		}

	document.getElementById('macl_link_table_'+table).className = 'BabMenuActiveBackground';

	var checkbox = document.getElementById('bab_groups_tree').getElementsByTagName('input');
	for(var i = 0; i < checkbox.length; i++ )
		{
		if (table_name(checkbox[i].name) != table) {
			checkbox[i].style.display = 'none';
			}
		else {
			checkbox[i].style.display = '';
			}

		if ('tree' == checkbox[i].name.substr(0,4))
			{
			checkbox[i].onclick = function() {
				var tree = document.getElementById(this.parentNode.parentNode.id).getElementsByTagName('input');
				for (var j = 0; j < tree.length ; j++)
					{
					if (this.name != tree[j].name || this.value != tree[j].value)
						tree[j].disabled = this.checked;
					}
				}
			}
		}

}
</script>

<div id="bab_groups_acl" class="BabLoginCadreBackground">
<ul class="BabLoginMenuBackground">
	<!--#in getnexttable -->
	<li id="macl_link_table_{ table }" onclick="macl_switch_view_on('{ table }')">{ title }</li>
	<!--#endin getnexttable -->
</ul>
</div>

<form method="post" action="{ babPhpSelf }">
<input type="hidden" name="tg" value="{ target }">
<input type="hidden" name="idx" value="{ index }">
<input type="hidden" name="item" value="{ id_object }">
<input type="hidden" name="table" value="">
<input type="hidden" name="what" value="">
<input type="hidden" name="{ return }" value="update">


<div id="bab_groups_tree" class="BabLoginCadreBackground">
	<p class="BabSiteAdminTitleFontBackground">
	<a href="javascript:tree.expand();" class="expand">{ t_expand_all }</a> 
	<a href="javascript:tree.collapse();" class="collapse">{ t_collapse_all }</a>
	<a href="javascript:tree.expandChecked();" class="expandchecked">{ t_expand_checked }</a>
	</p>
	<div class="tree">
	<ul class="first">
	<!--#in firstnode -->
	<li id="bab_ovgroup_{ arr[id] }">
		<div class="line">
		
		<img src="{ babSkinPath }images/Puces/folder_group.gif" alt="{ t_group }" />
		<!--#in getnexttable -->
		<input type="checkbox" name="tree[{ table }][]" value="{ arr[id] }" />
		<!--#endin getnexttable -->
		{ arr[name] }

			<div class="right">
				<!--#in getnexttable -->
				<input type="checkbox" name="group[{ table }][]" value="{ id_group }" <!--#if checked --> checked="checked" <!--#endif checked --> <!--#if disabled --> disabled="disabled" <!--#endif disabled --> />
				<!--#endin getnexttable -->
			</div>
		</div>
		{ tpl_tree }
		</li>
	<!--#endin firstnode -->
	</ul>
	<br />
	</div>
</div>

<div align="center">
	<input type="submit" value="{ t_record }" />
</div>

</form>

<script type="text/javascript">
var tree = new bab_ul_tree('bab_groups_tree');
tree.processList();
tree.expandChecked();
macl_switch_view_on();
</script>
<!--#end grp_maintree -->

<!--#begin grp_childs -->
	<ul>
		<!--#in getnextgroup -->
		<li id="bab_ovgroup_{ arr[id] }">
			<div>
			<img src="{ babSkinPath }images/Puces/folder_group.gif" alt="{ t_group }" />
			<!--#in getnexttable -->
			<input type="checkbox" name="tree[{ table }][]" value="{ arr[id] }" />
			<!--#endin getnexttable -->
			
			{ arr[name] }

			<div class="right">
				<!--#in getnexttable -->
				<input type="checkbox" name="group[{ table }][]" value="{ id_group }" <!--#if checked --> checked="checked" <!--#endif checked --> <!--#if disabled --> disabled="disabled" <!--#endif disabled --> />
				<!--#endin getnexttable -->
			</div>

			</div>
			{ subtree }
		</li>
		<!--#endin getnextgroup -->
	</ul>
<!--#end grp_childs -->