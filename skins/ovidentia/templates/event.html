
<!--#begin newevent -->
<form name="vacform" method="post" action="{ babPhpSelf }" >
<input type="hidden" name="tg" value="event">
<input type="hidden" name="idx" value="addevent">
<input type="hidden" name="curday" value="{ curday }">
<input type="hidden" name="curmonth" value="{ curmonth }">
<input type="hidden" name="curyear" value="{ curyear }">
<input type="hidden" name="curview" value="{ curview }">
<input type="hidden" name="calid" value="{ calid }">
<input type="hidden" name="addevent" value="add">
<table class="BabLoginCadreBackground" width="90%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr> 
<td> 
<table class="BabLoginMenuBackground" width="100%" border="0" cellspacing="0" cellpadding="5">
<tr> 
<td align="right" nowrap width="30%" valign="middle"><a class="BabEventFaqLink" 
href="javascript: Start('{ datebegin }', 'CalendarWindow', 'width=250,height=250,status=no,resizable=no,top=200,left=200');">{ datebegintxt }</a>:</td>
<td valign="middle" width="10%"> 
<select name="daybegin">
<!--#in getnextday -->
<option value="{ dayid }" { selected }>{ dayid }</option>
<!--#endin getnextday -->
</select>
</td>
<td valign="middle" width="10%"> 
<select name="monthbegin" onChange="updateDates(this.form.daybegin, this.form.monthbegin, this.form.yearbegin);">
<!--#in getnextmonth -->
<option value="{ monthid }" { selected }>{ monthname }</option>
<!--#endin getnextmonth -->
</select>
</td>
<td valign="middle" width="20%"> 
<select name="yearbegin" onChange="updateDates(this.form.daybegin, this.form.monthbegin, this.form.yearbegin);">
<!--#in getnextyear -->
<option value="{ yearid }"  { selected }>{ yearidval }</option>
<!--#endin getnextyear -->
</select>
</td>
<td width="30%">&nbsp;</td>
</tr>
<tr> 
<td align="right" nowrap valign="middle">{ daytype }:</td>
<td colspan="4" valign="middle"> 
<input type="checkbox" name="daytype" value="y" { daytypechecked }>
</td>
</tr>
<tr> 
<td align="right" nowrap valign="middle">{ or }:</td>
<td valign="middle" nowrap colspan="4"> 
<table class="BabLoginMenuBackground" border="0" cellspacing="0" cellpadding="0">
<tr> 
<td width="70" align="right" valign="middle">{ starttime }&nbsp;</td>
<td width="50" valign="middle"> 
<select name="timebegin">
<!--#in getnexttime -->
<option value="{ time }" { selected }>{ time }</option>
<!--#endin getnexttime -->
</select >
</td>
<td width="70" align="right" valign="middle">{ endtime }&nbsp;</td>
<td width="50" valign="middle"> 
<select name="timeend">
<!--#in getnexttime -->
<option value="{ timeval }" { selected }>{ time }</option>
<!--#endin getnexttime -->
</select >
</td>
</tr>
</table>
</td>
</tr>
<tr> 
<td align="right" nowrap valign="middle">{ repeat }:</td>
<td colspan="4" valign="middle"> 
<input type="checkbox" name="repeat" value="y">
</td>
</tr>
<tr> 
<td align="right" valign="top">{ daystext }:</td>
<td colspan="4" valign="top"> 
<select multiple name="days[]" size="7">
<!--#in getnextdays -->
<option value="{ days }">{ daysname }</option>
<!--#endin getnextdays -->
</select >
</td>
</tr>
<tr> 
<td align="right" nowrap valign="middle"><a class="BabEventFaqLink" href="javascript: Start('{ dateend }', 'CalendarWindow', 'width=250,height=250,status=no,resizable=no,top=200,left=200');">{ dateendtxt }</a>:</td>
<td valign="middle"> 
<select name="dayend">
<!--#in getnextday -->
<option value="{ dayid }" { selected }>{ dayid }</option>
<!--#endin getnextday -->
</select>
</td>
<td valign="middle"> 
<select name="monthend" onChange="updateDates(this.form.dayend, this.form.monthend, this.form.yearend);">
<!--#in getnextmonth -->
<option value="{ monthid }" { selected }>{ monthname }</option>
<!--#endin getnextmonth -->
</select>
</td>
<td valign="middle"> 
<select name="yearend" onChange="updateDates(this.form.dayend, this.form.monthend, this.form.yearend);">
<!--#in getnextyear -->
<option value="{ yearid }"  { selected }>{ yearidval }</option>
<!--#endin getnextyear -->
</select>
</td>
<td>&nbsp;</td>
</tr>
<tr> 
<td align="right" valign="middle">{ title }:</td>
<td colspan="4" valign="middle"> 
<input type="text" name="title" size="45" maxlength="100" value="{ titleval }">
</td>
</tr>
<!--#if bcategory "== 1" -->
<tr> 
<td align="right" valign="middle">{ category }</td>
<td colspan="4" valign="middle"> 
<select name="category">
<option value="" selected ></option>
<!--#in getnextcat -->
<option value="{ catid }">{ catname }</option>
<!--#endin getnextcat -->
</select>
</td>
</tr>
<!--#endif bcategory -->
<!-- toolbar -->
<!--#if msie "== 1" -->
<script src="{ babScriptPath }{ babLanguage }/editorlang.js"></script>
<script src="{ babScriptPath }editor.js"></script>
<tr> 
<td align="right" nowrap>&nbsp;</td>
<td colspan="4"> 
<textarea cols="1" rows="1" style="VISIBILITY: hidden" name="description">{ descriptionval }</textarea>
</td>
</tr>
<tr> 
<td colspan="5" align="center"> 
<script language="JavaScript"> 
	var idGenerator = new IDGenerator(0);
	var editor = new Editor(idGenerator, '{ babEditorImages }');
	editor.ToolBar();
</script>
</td>
</tr>
<!--#endif msie -->
<tr> 
<td colspan="5" align="center">{ description }</td>
</tr>
<tr> 
<td align="center" colspan="5"> 
<!--#if msie "== 1" -->
<script language="JavaScript">
	editor.InFrame(0, "description", "vacform", "100%", "160");
</script>
<!--#else msie -->
<textarea cols="40" rows="5" name="description">{ descriptionval }</textarea>
<!--#endif msie -->
</td>
</tr>


<tr> 
<td colspan="2" align="center" valign="middle">{ usrcalendarstxt }</td>
<td colspan="2" align="center" valign="middle">{ grpcalendarstxt }</td>
<td colspan="2" align="center" valign="middle">{ rescalendarstxt }</td>
</tr>

<!--#in getnextrow -->
<tr> 
<td colspan="2" align="left" valign="middle">
<!--#if busrcal -->
<input type="checkbox" name="usrcals[]" value="{ usrcalid }" { usrsel }>{ usrcalname }
<!--#else busrcal -->&nbsp;
<!--#endif busrcal -->
</td>
<td colspan="2" align="left" valign="middle">
<!--#if bgrpcal -->
<input type="checkbox" name="grpcals[]" value="{ grpcalid }" { grpsel }>{ grpcalname }
<!--#else bgrpcal -->&nbsp;
<!--#endif bgrpcal -->
</td>
<td colspan="2" align="left" valign="middle">
<!--#if brescal -->
<input type="checkbox" name="rescals[]" value="{ rescalid }" { ressel }>{ rescalname }
<!--#else brescal -->&nbsp;
<!--#endif brescal -->
</td>
</tr>
<!--#endin getnextrow -->

<!--#if msie "== 1" -->
<tr> 
<td>&nbsp;</td>
<td colspan="4"> 
<input onClick=SetVals() type="submit" name="Submit" value="{ addvac }">
<br>
</td>
</tr>
<script language="JavaScript">
	editor.FinalInstantiate(0);
	editor.CloseInitSection();
</script>
<!--#else msie -->
<tr> 
<td nowrap>&nbsp;</td>
<td colspan="4"> 
<input type="submit" name="Submit" value="{ addvac }">
<br>
</td>
</tr>
<!--#endif msie -->
</table>
</td>
</tr>
</table>
</form>
<br>
<!--#end newevent -->
<br><br><br><br><br>
<!--#begin modifyevent -->
<form name="vacform" method="post" action="{ babPhpSelf }" >
<input type="hidden" name="tg" value="event">
<input type="hidden" name="idx" value="modify">
<input type="hidden" name="curday" value="{ curday }">
<input type="hidden" name="curmonth" value="{ curmonth }">
<input type="hidden" name="curyear" value="{ curyear }">
<input type="hidden" name="curview" value="{ curview }">
<input type="hidden" name="calid" value="{ calid }">
<input type="hidden" name="evtid" value="{ evtid }">
<input type="hidden" name="modifyevent" value="modify">
<table class="BabLoginCadreBackground" width="60%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr>
<td>
<table class="BabLoginMenuBackground" width="100%" border="0" cellspacing="0" cellpadding="3">
<tr> 
<td align="right" nowrap width="25%" valign="middle"><a class="BabEventFaqLink" href="javascript: Start('{ datebegin }', 'CalendarWindow', 'width=250,height=250,status=no,resizable=no,top=200,left=200');">{ 
datebegintxt }</a>:</td>
<td width="15%" valign="middle"> 
<select name="daybegin">
<!--#in getnextday -->
<option value="{ dayid }" { selected }>{ dayid }</option>
<!--#endin getnextday -->
</select>
</td>
<td width="15%" valign="middle"> 
<select name="monthbegin" onChange="updateDates(this.form.daybegin, this.form.monthbegin, this.form.yearbegin);">
<!--#in getnextmonth -->
<option value="{ monthid }" { selected }>{ monthname }</option>
<!--#endin getnextmonth -->
</select>
</td>
<td valign="middle" width="45%"> 
<select name="yearbegin" onChange="updateDates(this.form.daybegin, this.form.monthbegin, this.form.yearbegin);">
<!--#in getnextyear -->
<option value="{ yearid }"  { selected }>{ yearidval }</option>
<!--#endin getnextyear -->
</select>
</td>
</tr>
<tr> 
<td align="right" nowrap valign="middle"><a class="BabEventFaqLink" href="javascript: Start('{ dateend }', 'CalendarWindow', 'width=250,height=250,status=no,resizable=no,top=200,left=200');">{ 
dateendtxt }</a>:</td>
<td valign="middle"> 
<select name="dayend">
<!--#in getnextday -->
<option value="{ dayid }" { selected }>{ dayid }</option>
<!--#endin getnextday -->
</select>
</td>
<td valign="middle"> 
<select name="monthend" onChange="updateDates(this.form.dayend, this.form.monthend, this.form.yearend);">
<!--#in getnextmonth -->
<option value="{ monthid }" { selected }>{ monthname }</option>
<!--#endin getnextmonth -->
</select>
</td>
<td valign="middle"> 
<select name="yearend" onChange="updateDates(this.form.dayend, this.form.monthend, this.form.yearend);">
<!--#in getnextyear -->
<option value="{ yearid }"  { selected }>{ yearidval }</option>
<!--#endin getnextyear -->
</select>
</td>
</tr>
<tr> 
<td align="right" nowrap valign="middle">{ starttime }</td>
<td valign="middle"> 
<select name="timebegin">
<!--#in getnexttime -->
<option value="{ timeval }" { selected }>{ time }</option>
<!--#endin getnexttime -->
</select >
</td>
<td align="right" nowrap valign="middle">{ endtime }</td>
<td valign="middle"> 
<select name="timeend">
<!--#in getnexttime -->
<option value="{ time }" { selected }>{ time }</option>
<!--#endin getnexttime -->
</select >
</td>
</tr>
<tr> 
<td align="right" valign="middle">{ title }:</td>
<td colspan="4" valign="middle"> 
<input type="text" name="title" size="50" maxlength="255" value="{ evtarr[title] }">
</td>
</tr>
<tr>
<tr> 
<td align="right" valign="top">&nbsp;</td>
<td colspan="4" valign="top">&nbsp;</td>
</tr>
<tr> 
<td align="right" valign="top"><a class="BabEventFaqLink" href="javascript: Start('{ descurl }', 'Editor', 'width=600,height=400,status=no,resizable=yes,top=200,left=200');">{ description }</a></td>
<td colspan="4" valign="top">{ evtarr[description] }</td>
</tr>
<tr> 
<td align="right" valign="top">&nbsp;</td>
<td colspan="4" valign="top">&nbsp;</td>
</tr><!--#if bcategory "== 1" -->
<tr> 
<td align="right" valign="middle">{ category }</td>
<td colspan="4" valign="middle"> 
<select name="category">
<option value="" selected ></option>
<!--#in getnextcat -->
<option value="{ catid }" { selected }>{ catname }</option>
<!--#endin getnextcat -->
</select>
</td>
</tr>
<!--#endif bcategory -->
<tr> 
<td>&nbsp;</td>
<td colspan="4"> 
<input type="submit" name="Submit" value="{ modify }">
<!--#if bmodif -->
&nbsp;&nbsp;<input type="submit" name="evtdel" value="{ delete }">
<!--#endif bmodif -->
<br>
</td>
</tr>
</table>
</td>
</tr>
</table>
</form>
<br>
<!--#end modifyevent -->
<br><br><br><br><br>

<!--#begin viewevent -->
<br>
<br>
<table  width="80%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr> 
<td class="BabLoginCadreBackground"> 
<table width="100%" border="0" cellspacing="0" cellpadding="5" align="center">
<tr> 
<td class="BabSiteAdminTitleFontBackground" width="35%" nowrap valign="middle"><b>{ titlename }</b></td>
<td class="BabSiteAdminTitleFontBackground" width="65%" valign="middle">{ title } </td>
</tr>
<tr> 
<td class="BabSiteAdminTitleFontBackground" nowrap valign="middle"><b>{  startdatename }</b></td>
<td class="BabSiteAdminTitleFontBackground" valign="middle">{ startdate } </td>
</tr>
<tr> 
<td class="BabSiteAdminTitleFontBackground" nowrap valign="middle"><b>{ enddatename }</b></td>
<td class="BabSiteAdminTitleFontBackground" valign="middle">{ enddate } </td>
</tr>
<tr> 
<td class="BabSiteAdminTitleFontBackground" nowrap valign="middle"><b>{ descriptionname }</b></td>
<td class="BabSiteAdminTitleFontBackground" valign="middle">{ description } </td>
</tr>
</table>
</td>
</tr>
</table>
<!--#end viewevent -->

<!--#begin descmodify -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<TITLE>{ babSiteName }</TITLE>
	<META http-equiv="Pragma" content="no-cache">
	<META name="Generator" content="Ovidentia">
	<META name="Author" content="Ovidentia Community">
	<META name="Keywords" content="">
	<META name="Description" content="">
	{ babCss }
<script type="text/javascript">
<!--
//-->
</script>
</HEAD>
<BODY>
<br>
<form name="descmod" method="post" action="{ babPhpSelf }">
<input type="hidden" name="tg" value="event">
<input type="hidden" name="idx" value="updesc">
<input type="hidden" name="calid" value="{ calid }">
<input type="hidden" name="evtid" value="{ evtid }">
<input type="hidden" name="update" value="desc">
<table class="BabLoginCadreBackground" width="80%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr> 
<td> 
<table class="BabLoginMenuBackground" width="100%" border="0" cellspacing="0" cellpadding="5" align="center">
<tr> 
<td align="center" valign="middle">{ evtdesc }</td>
</tr>
<!-- Instanciation de la barre d'outils -->
<!--#if msie "== 1" -->
<script src="{ babScriptPath }{ babLanguage }/editorlang.js"></script>
<script src="{ babScriptPath }editor.js"></script>
<td> 
<textarea cols="1" rows="1" style="VISIBILITY: hidden" name="content">{ arr[description] }</textarea>
</td>
</tr>
<tr align="center" valign="middle"> 
<td> 
     <script language="JavaScript"> 
	var idGenerator = new IDGenerator(0);
	var editor = new Editor(idGenerator, '{ babEditorImages }');
	editor.ToolBar();
	</script>
</td>
</tr>
<!--#endif msie -->
<tr> 
<td align="center" valign="middle"> 
<!--#if msie "== 1" -->
	            <script language="JavaScript">
	editor.InFrame(0, "content", "descmod", "90%", "160");
				</script>
<!--#else msie -->
<textarea cols="50" rows="20" name="content">{ arr[description] }</textarea>
<!--#endif msie -->
</td>
</tr>
<!--#if msie "== 1" -->
<tr> 
<td align="center" valign="middle">
<input onClick=SetVals() type="submit" name="submit" value="{ modify }">
<br>
</td>
</tr>
        <script language="JavaScript">
		editor.FinalInstantiate(0);
		editor.CloseInitSection();
		</script>
<!--#else msie -->
<tr> 
<td align="center" valign="middle">
<input type="submit" name="submit" value="{ modify }">
<br>
</td>
</tr>
<!--#endif msie -->
</table>
</td>
</tr>
</table>
</form>
<br>
</BODY>
</HTML>
<!--#end descmodify -->
<!--#begin eventunload -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<TITLE>{ sitename }</TITLE>
<META http-equiv="Pragma" content="no-cache">
<META name="Generator" content="Bab">
<META name="Author" content="">
<META name="Keywords" content="">
<META name="Description" content="">
{ babCss }
<script type="text/javascript">
<!--
//-->
</script>

</HEAD>
<BODY onUnload="this.opener.location.reload()">
<br><br><br><br>

<table class="BabLoginMenuBackground" width="50%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr> 
<td> 
<table class="" width="100%" border="0" cellspacing="0" cellpadding="5" align="center">
<tr> 
<td class="BabErrorMessage" colspan="2" align="center">{ message } </td>
</tr>
</table>
</td>
</tr>
</table>
<br>

<script type="text/javascript">
	setTimeout("this.close()","1000");
</script>

</BODY>
</HTML>
<!--#end eventunload -->

<!--#begin scripts -->
<SCRIPT language="JavaScript">
<!--
function updateDates(elemDay, elemMonth, elemYear)
{
	ds = elemDay.selectedIndex;
	timeA = new Date(elemYear.options[elemYear.selectedIndex].text, elemMonth.options[elemMonth.selectedIndex].value,1);
	timeDifference = timeA - 86400000;
	timeB = new Date(timeDifference);
	var daysInMonth = timeB.getDate();
	for (var i = 0; i < elemDay.length; i++)
	{
	elemDay.options[0] = null;
	}
	for (var i = 0; i < daysInMonth; i++)
	{
	elemDay.options[i] = new Option(i+1);
	}
	if( ds < daysInMonth )
	elemDay.options[ds].selected = true;
	else
	elemDay.options[daysInMonth-1].selected = true;
}

function dateBegin(day, month, year)
{
	document.vacform.elements['daybegin'].options[day-1].selected = true;
	document.vacform.elements['monthbegin'].options[month-1].selected = true;
	document.vacform.elements['yearbegin'].options[year-{ yearmin }].selected = true;

}

function dateEnd(day, month, year)
{
	document.vacform.elements['dayend'].options[day-1].selected = true;
	document.vacform.elements['monthend'].options[month-1].selected = true;
	document.vacform.elements['yearend'].options[year-{ yearmin }].selected = true;

}
//-->
</SCRIPT>
<!--#end scripts -->

