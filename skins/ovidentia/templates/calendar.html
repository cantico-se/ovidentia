
<!--#begin listattendees -->
<!--#if access -->
<table border="0" width="90%" cellpadding="2" cellspacing="0" align="center">
<tr> 
<td class="BabLoginCadreBackground"> 
	<table border="0" width="100%" cellpadding="2" cellspacing="0">
	<tr class="BabSiteAdminTitleFontBackground"> 
		<td>{ fullnametxt }</td>
		<td align="right">{ statustxt }</td>
	</tr>
	<!--#in getnextuser -->
	<!--#if altbg --><tr class="BabSiteAdminFontBackground"><!--#else altbg --><tr class="BabForumBackground1"><!--#endif altbg -->
		<td>
		<!--#if bcreator -->
		<strong>{ fullname }</strong>
		<!--#else bcreator -->
		{ fullname }
		<!--#endif bcreator -->
		</td>
		<td align="right">{ status }</td>
	</tr>        
	<!--#endin getnextuser -->
	<tr class="BabSiteAdminTitleFontBackground"> 
		<td>&nbsp;</td>
		<td>&nbsp;</td>
	</tr>
	</table>
</td>
</tr>
</table>

<!--#if countstatus -->
<br />
<form method="post" action="{ babPhpSelf }">
<input type="hidden" name="tg" value="calendar">
<input type="hidden" name="idx" value="unload">
<input type="hidden" name="conf" value="event">
<input type="hidden" name="evtid" value="{ evtid }">
<input type="hidden" name="idcal" value="{ idcal }">
<br>
<table width="95%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr>
<td class="BabSiteAdminFontBackground" align="right" width="30%">&nbsp;</td><td class="BabSiteAdminFontBackground" align="left">
<select name="bconfirm">
<!--#in getnextstatus -->
<option value="{ statusval }">{ statusname }</option>
<!--#endin getnextstatus -->
</select>
</td>
</tr>
<!--#if brepetitive -->
<tr>
<td class="BabSiteAdminFontBackground" align="right" width="30%">&nbsp;</td><td class="BabSiteAdminFontBackground" align="left">
{ repetitivetxt }
</td>
</tr>
<tr>
<td class="BabSiteAdminFontBackground" align="right" width="30%">&nbsp;</td><td class="BabSiteAdminFontBackground" align="left">
<select name="bupdrec">
<option value="1"  selected>{ all }</option>
<option value="2">{ thisone }</option>
</select>
</td>
</tr>
<!--#endif brepetitive -->
<tr>
<td class="BabSiteAdminFontBackground" align="right" width="30%"><b>{ commenttxt }:</b></td><td class="BabSiteAdminFontBackground" align="left"><textarea cols="40" rows="10" name="comment"></textarea>
</td>
</tr>
<tr>
<td class="BabSiteAdminFontBackground" align="right" width="30%">&nbsp;</td><td class="BabSiteAdminFontBackground" align="left"><input type="submit" name="block" value="{ updatetxt }">
</td>
</tr>
</table>
</td>
</tr>
</table>
</form>
<!--#endif countstatus -->
<!--#endif access -->
<!--#end listattendees -->

<!--#begin eventdetail -->
<!--#if access -->
<table  width="50%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr> 
<td class="BabLoginCadreBackground" align="center" valign="middle"> 
<table  width="100%" border="0" cellspacing="0" cellpadding="5" align="center" class="BabLoginMenuBackground">
<tr> 
<td align="right" nowrap valign="middle"><b>{ begindatetxt }</b></td>
<td align="left" valign="middle">{ begindate }</td>
</tr>
<tr> 
<td align="right" nowrap valign="middle"><b>{ enddatetxt }</b></td>
<td align="left" valign="middle">{ enddate }</td>
</tr>
<tr> 
<td align="right" nowrap valign="middle"><b>{ titletxt }</b></td>
<td align="left" valign="middle">{ title }</td>
</tr>
<tr> 
<td align="right" nowrap valign="middle"><b>{ desctxt }</b></td>
<td align="left" valign="middle">{ description }</td>
</tr>
<tr> 
<td align="right" nowrap valign="middle"><b>{ cattxt }</b></td>
<td align="left" valign="middle">{ category }</td>
</tr>
</table>
</td>
</tr>
</table>
<!--#endif access -->
<!--#end eventdetail -->

<!--#begin calendarchoice -->
<script type="text/javascript">
<!--

function optionInGroup(grp,optvalue)
	{
	if (typeof grp == 'undefined')
		return true;

	var option = grp.getElementsByTagName('option');

	for (var j = 0; j < option.length ; j++)
		{
		if (option.item(j).value == optvalue)
			return true;
		}

	return false;
	}

var assoc = new Array();

function moveOptions(src,dest)
{	
	var destoptgroup = dest.getElementsByTagName('optgroup');
	var srcoptgroup = src.getElementsByTagName('optgroup');

	
	var destgroups = new Array();
	

	if (assoc.length == 0)
		{
		for (var i = 0; i < srcoptgroup.length ; i++)
			{
			var option = srcoptgroup[i].getElementsByTagName('option');

			for (var j = 0; j < option.length ; j++)
				{
				assoc[option.item(j).value] = srcoptgroup[i]['className'];
				}
			}
		}

	for (var i = 0; i < destoptgroup.length ; i++)
		{
		destgroups[destoptgroup[i]['className']] = destoptgroup[i];
		var option = destoptgroup[i].getElementsByTagName('option');
		for (var j = 0; j < option.length ; j++)
			{
			assoc[option.item(j).value] = destoptgroup[i]['className'];
			}
		}

	srclen = src.options.length;
	if (srclen == 0) return;
	reslen = dest.options.length + srclen;
	resopt = new Array(reslen);
	destcnt = 0;
	rescnt = 0;
	nbsel = 0;

	while(destcnt < dest.options.length)
		{
		resopt[rescnt] = new Option(dest.options[destcnt].text, dest.options[destcnt].value);
		destcnt++;
		rescnt++;
		}
	for(i = 0; i < srclen; i++)
		{
		while((i < srclen) && (src.options[i].selected == false))
			i++;
		if(i < srclen)
			{
			nbsel++;
			resopt[rescnt] = new Option(src.options[i].text, src.options[i].value);
			src.options[i] = null;
			i--;
			srclen--;
			rescnt++;
			}
		}

	
	for(i=0; i < nbsel;i++)
		{
		dest.options[i] = null;
		dest.options[i] = resopt[rescnt - nbsel + i];
		}

	for(i=0; i < rescnt - nbsel; i++)
		{
		dest.options[nbsel + i] = null;
		dest.options[nbsel + i] = resopt[i];
		}

	var sort = true;
	
	while (sort)
		{
		var loop = false;
		for (i=0 ; i < dest.options.length ; i++ )
			{
			if (destgroups[assoc[dest.options[i].value]])
				destgroups[assoc[dest.options[i].value]].appendChild(dest.options[i]);
			if (!optionInGroup(destgroups[assoc[dest.options[i].value]],dest.options[i].value))
				loop = true;
			}
		sort = loop ? true : false;
		}
}

function movecalendar(action)
	{
	//{}
	var form = '{ formname }';
	var src = document.forms[form].calendars;
	var dest = document.forms[form].elements['selected_calendars[]'];

	switch (action)
		{

		case 0:
			moveOptions(src,dest);
			break;
		case 1:
			moveOptions(dest,src);
			break;
		}
	}


function calendarChoice_selectAll(formname)
	{
	var list = document.forms[formname].elements['selected_calendars[]'];
	for(i=0; i < list.options.length; i++)
	{
		list.options[i].selected = true;
	}
	}
//-->
</script>
<table align="center" width="100%">
	<tr>
		<td width="45%">
		<h5>{ t_calendars1 }</h5>
		<select name="calendars" multiple="multiple" size="10" style="width:100%">
			<optgroup class="usr" label="{ usrcalendarstxt }">
			<!--#in getnextusrcal -->
				<option value="{ id }" { selected }>{ name }</option>
			<!--#endin getnextusrcal -->
			</optgroup>
			<optgroup class="grp" label="{ grpcalendarstxt }">
			<!--#in getnextpubcal -->
				<option value="{ id }" { selected }>{ name }</option>
			<!--#endin getnextpubcal -->
			</optgroup>
			<optgroup class="res" label="{ rescalendarstxt }">
			<!--#in getnextrescal -->
				<option value="{ id }" { selected }>{ name }</option>
			<!--#endin getnextrescal -->
			</optgroup>
		</select>
		</td>

		<td align="center">
			<a href="javascript:movecalendar(0)" title="{ t_goright }"><img alt="{ t_goright }" src="{ babSkinPath }images/Puces/PuceGoRight.gif" border="0" /></a>
			<br /><br />
			<a href="javascript:movecalendar(1)" title="{ t_goleft }"><img alt="{ t_goleft }" src="{ babSkinPath }images/Puces/PuceGoLeft.gif" border="0" /></a>
		</td>

		<td width="45%">
			<h5>{ t_calendars2 }</h5>
			<select name="selected_calendars[]" multiple="multiple" size="10" style="width:100%">
				<optgroup class="usr" label="{ usrcalendarstxt }">
				</optgroup>
				<optgroup class="grp" label="{ grpcalendarstxt }">
				</optgroup>
				<optgroup class="res" label="{ rescalendarstxt }">
				</optgroup>
			</select>
		</td>
	</tr>
</table>
<script type="text/javascript">
<!--
movecalendar(0);
//-->
</script>
<!--#end calendarchoice -->


<!--#begin categorieslist -->
<BR>
<table  width="0" cellpadding="5" cellspacing="0" align="left">
<tr>
<td > 
<table cellpadding="2" cellspacing="2">        
<tr>
<td>
&nbsp;
</td>
<td class="BabMenuActiveBackground">
{ description } 
</td>
</tr>
<tr>
<td>
&nbsp;
</td><td>
&nbsp;
</td>
</tr>
<!--#in getnextcat -->
<tr> 
<td bgcolor="#{ bgcolor }" width="10">&nbsp;</td>
<td>&nbsp;{ catdesc }</td>
</tr>
<!--#endin getnextcat -->
</table>
</td>
</tr>
</table>
<!--#end categorieslist -->


<!--#begin searchavailability -->
<SCRIPT language="JavaScript">
<!--
function dateBegin(day, month, year)
{
	document.calrform.vdate0.value = day+'-'+month+'-'+year;
	document.calrform.date0.value = year+','+month+','+day;
}

function dateEnd(day, month, year)
{
	document.calrform.vdate1.value = day+'-'+month+'-'+year;
	document.calrform.date1.value = year+','+month+','+day;
}
//-->
</SCRIPT>
<form name="calrform" method="post" action="{ babPhpSelf }">
<input type="hidden" name="tg" value="{ tg }" />
<input type="hidden" name="idx" value="rfree" />
<input type="hidden" name="calid" value="{ calid }" />
<input type="hidden" name="date" value="{ date }" />
<table class="BabLoginCadreBackground" width="90%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr> 
<td> 
	<table class="BabLoginMenuBackground" width="100%" border="0" cellspacing="0" cellpadding="5">
	<tr> 
		<td align="right">
			<a class="BabEventFaqLink" href="javascript: Start('{ datebeginurl }', 'CalendarWindow', 'width=250,height=250,status=no,resizable=no,top=200,left=200');">{ datebegintxt }</a>:
		</td>
		<td nowrap>
		<input type="text" name="vdate0" size="10" maxlength="10" value="{ date0val }" disabled />
		<input type="hidden" name="date0" size="10" maxlength="10" value="{ date0 }" />
		</td>
	</tr>
	<tr> 
		<td align="right">
			<a class="BabEventFaqLink" href="javascript: Start('{ dateendurl }', 'CalendarWindow', 'width=250,height=250,status=no,resizable=no,top=200,left=200');">{ dateendtxt }</a>:
		</td>
		<td nowrap>
		<input type="text" name="vdate1" size="10" maxlength="10" value="{ date1val }" disabled />
		<input type="hidden" name="date1" size="10" maxlength="10" value="{ date1 }" />
		</td>
	</tr>
	<tr> 
		<td align="right">{ gaptxt }:</td>
		<td> 
			<select name="gap">
			<option value="" ></option>
			<!--#in getnextgap -->
			<option value="{ gapval }" { selected }>{ gapname }</option>
			<!--#endin getnextgap -->
			</select>
		</td>
	</tr>
	<tr> 
		<td align="right">{ optiontxt }:</td>
		<td> 
			<select name="bopt">
			<option value="Y" selected >{ yes }</option>
			<option value="N">{ no }</option>
			</select>
		</td>
	</tr>
	<tr>
		<td colspan="2" align="center"><input type="submit" name="Submit" value="{ searchtxt }"></td>
	</tr>
	</table>
</td>
</tr>
</table>
</form>
<br>
<table border="0" width="90%" cellpadding="2" cellspacing="0" align="center">
<tr> 
<td class="BabLoginCadreBackground"> 
	<table border="0" width="100%" cellpadding="2" cellspacing="0">
	<tr class="BabSiteAdminTitleFontBackground"> 
		<td>{ datestxt }</td>
		<td align="right">{ intervaltxt }</td>
	</tr>
	<!--#in getnextfreeevent -->
	<!--#if altbg --><tr class="BabSiteAdminFontBackground"><!--#else altbg --><tr class="BabForumBackground1"><!--#endif altbg -->
		<td>
			<a class="BabSiteAdminListLink" href="{ refurl }">{ startdate }&nbsp;{ starttime }&nbsp;/&nbsp;{ enddate }&nbsp;{ endtime }</a>
		</td>
		<td align="right">{ interval }</td>
	</tr>        
	<!--#endin getnextfreeevent -->
	<tr class="BabSiteAdminTitleFontBackground"> 
		<td>&nbsp;</td>
		<td>&nbsp;</td>
	</tr>
	</table>
</td>
</tr>
</table>
<!--#end searchavailability -->

<!--#begin eventlist -->
<style type="text/css">
@import url('{ babInstallPath }styles/calendar.css');
</style>
<ul id="eventlist">
<!--#in getnextevent -->
	<!--#if evt[private] -->
	<li id="event{ idevent }">
		<h3>{ t_private }</h3>
	</li>
	<!--#else evt[private] -->
	<li id="event{ idevent }" style="color:#{ evt[color] }">
		<h3>{ evt[title] }</h3>
		<h4>{ evt[start_date] } <span>-</span> { evt[end_date] }</h4>
		<!--#if evt[categoryname] -->
		<h5 title="{ evt[categorydescription] }" style="color:#{ evt[color] }"><span title="{ evt[categorydescription] }">{ evt[categoryname] }</span></h5>
		<!--#endif evt[categoryname] -->
		<!--#if evt[creator] -->
		<h6>{ evt[creator] }</h6>
		<!--#endif evt[creator] -->
		<!--#if evt[description] -->
		<p>{ evt[description] }</p>
		<!--#endif evt[description] -->
		<ul>
		<!--#in getnextcalendar -->
			<li><strong>{ calendar[type] } : </strong>{ calendar[name] }</li>
		<!--#endin getnextcalendar -->
		</ul>
	</li>
	<!--#endif evt[private] -->
<!--#endin getnextevent -->
</ul>
<div class="bab_cal_buttons">
<a class="print" href="javascript:window.print()">{ t_print }</a>
</div>
<!--#end eventlist -->