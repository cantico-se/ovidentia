
<!--#begin workslist -->
<table width="95%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr> 
<td class="BabLoginCadreBackground"> 
<table width="100%" border="0" cellspacing="0" cellpadding="5" align="center">
<tr> 
<td class="BabSiteAdminTitleFontBackground" valign="middle" nowrap ><b>{ nametxt }</b> </td>
<td class="BabSiteAdminTitleFontBackground" valign="middle" align="left"><b>&nbsp;{ managertxt }</b></td>
<td class="BabSiteAdminTitleFontBackground" valign="middle" align="left"><b>&nbsp;{ desctxt }</b></td>
</tr>
<!--#in getnext -->
<tr> 
<td class="BabSiteAdminFontBackground" valign="middle"><a class="BabSiteAdminListLink" href="{ url }">{ name }</a> </td>
<td class="BabSiteAdminFontBackground" align="left" valign="middle">&nbsp;{ manager }</td>
<td class="BabSiteAdminFontBackground" align="left" valign="middle">&nbsp;{ desc }</td>
</tr>
<!--#endin getnext -->
</table>
</td>
</tr>
</table>
<br>
<!--#end workslist -->

<!--#begin worktypeslist -->
<form name="wcreate" method="post" action="{ babPhpSelf }">
<input type="hidden" name="tg" value="{ babAddonTarget }/admin">
<input type="hidden" name="idx" value="delwtl">
<table width="95%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr> 
<td class="BabLoginCadreBackground"> 
<table width="100%" border="0" cellspacing="0" cellpadding="5" align="center">
<tr> 
<td class="BabSiteAdminTitleFontBackground" valign="middle" nowrap ><b>{ nametxt }</b> </td>
<td class="BabSiteAdminTitleFontBackground" width="1%" valign="middle" align="right">&nbsp;</td>
</tr>
<!--#in getnext -->
<tr> 
<td class="BabSiteAdminFontBackground" valign="middle"><a class="BabSiteAdminListLink" href="{ url }">{ name }</a> </td>
<td class="BabSiteAdminFontBackground" align="left" valign="middle">&nbsp;<input type="checkbox" name="wtlist[]" value="{ wtid }"></td>
</tr>
<!--#endin getnext -->
<tr> 
<td class="BabSiteAdminTitleFontBackground" valign="middle" nowrap >&nbsp;</td>
<td class="BabSiteAdminTitleFontBackground" width="1%" valign="middle" align="right">&nbsp;<a href="javascript:submitForm('delwtl', 'wcreate')"><img src="{ babSkinPath }images/Puces/del.gif" alt="{ delwt }" border="0"></a></td>
</tr>
</table>
</td>
</tr>
</table>
</form>
<br>
<!--#end worktypeslist -->

<!--#begin addwork -->
<script type="text/javascript">
<!--
function onApprover(id, fn)
{
document.forms.wcreate.manager.value=fn;
document.forms.wcreate.managerid.value=id;
this.focus();
op.close();
}

var op = null;
function openPopup(url)
{
if( op == null || op.closed )
	op = this.open(url+'onApprover', 'babuserslist', 'width=550,height=550,status=no,resizable=yes,top=200,left=200,scrollbars=yes');
else
	op.focus();
}
//-->
</script>
<form name="wcreate" method="post" action="{ babPhpSelf }">
<input type="hidden" name="tg" value="{ babAddonTarget }/admin">
<input type="hidden" name="idx" value="{ what }">
<input type="hidden" name="id" value="{ id }">
<table class="BabLoginCadreBackground"  width="50%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr> 
<td> 
<table class="BabLoginMenuBackground" width="100%" border="0" cellspacing="0" cellpadding="5" align="center">
<tr> 
<td class="BabLoginMenuBackground" width="30%" align="right" nowrap valign="middle">{ name }</td>
<td class="BabLoginMenuBackground" width="70%" valign="middle">
<input type="text" name="wname" size="30" value="{ wname }">
</td>
</tr>
<tr> 
<td class="BabLoginMenuBackground" align="right" nowrap valign="middle">{ description }</td>
<td class="BabLoginMenuBackground" valign="middle">
<input type="text" name="wdesc" size="45" value="{ wdesc }">
</td>
</tr>
<tr> 
<td class="BabLoginMenuBackground" align="right" nowrap valign="middle">{ worktype }</td>
<td class="BabLoginMenuBackground" valign="middle">
<select name="wtype">
<option value="0"></option>
<!--#in getnext -->
<option value="{ wtid }" { selected }>{ wtlabel }</option>
<!--#endin getnext -->
</select>
</td>
</tr>
<tr> 
<td class="BabLoginMenuBackground" align="right" nowrap valign="middle"><a class="BabAlphabetLink" href="javascript: openPopup('{ usersbrowurl }');">{ manager }</a>:</td>
<td class="BabLoginMenuBackground" valign="middle">
<input type="text" name="manager" size="45" maxlength="255" value="{ managerval }" disabled>
<input type="hidden" name="managerid" value="{ managerid }">
</td>
</tr>
<tr> 
<td class="BabLoginMenuBackground" nowrap>&nbsp;</td>
<td class="BabLoginMenuBackground" valign="middle">
<input type="submit" name="addw" value="{ add }">
<!--#if bdel -->
&nbsp;&nbsp;<input type="submit" name="delw" value="{ delete }">
<!--#endif bdel -->
<br>
</td>
</tr>
</table>
</td>
</tr>
</table>
</form>
<!--#end addwork -->

<!--#begin addworktype -->
<form name="wtcreate" method="post" action="{ babPhpSelf }">
<input type="hidden" name="tg" value="{ babAddonTarget }/admin">
<input type="hidden" name="idx" value="{ what }">
<input type="hidden" name="id" value="{ id }">
<table class="BabLoginCadreBackground"  width="50%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr> 
<td> 
<table class="BabLoginMenuBackground" width="100%" border="0" cellspacing="0" cellpadding="5" align="center">
<tr> 
<td class="BabLoginMenuBackground" width="30%" align="right" nowrap valign="middle">{ name }</td>
<td class="BabLoginMenuBackground" width="70%" valign="middle">
<input type="text" name="wname" size="30" value="{ wtname }">
</td>
</tr>
<tr> 
<td class="BabLoginMenuBackground" nowrap>&nbsp;</td>
<td class="BabLoginMenuBackground" valign="middle">
<input type="submit" name="addw" value="{ add }">
<!--#if bdel -->
&nbsp;&nbsp;<input type="submit" name="delw" value="{ delete }">
<!--#endif bdel -->
<br>
</td>
</tr>
</table>
</td>
</tr>
</table>
</form>
<!--#end addworktype -->

<!--#begin exporttasks -->
<script language="JavaScript">
<!--
function move(bDir, el)
	{
	var idx = el.selectedIndex
	if (idx !=-1 && idx != 0) 
	{
		if( idx == 1 && bDir == true)
			return;
		if( idx == el.options.length-1 && bDir == false)
			return;
		var nxidx = idx + ( bDir ? - 1 : 1)
		if ( nxidx<0 )
			nxidx=el.length-1
		if ( nxidx>=el.length) nxidx=0
		var oldVal = el[idx].value
		var oldText = el[idx].text
		el[idx].value = el[nxidx].value
		el[idx].text = el[nxidx].text
		el[nxidx].value = oldVal
		el[nxidx].text = oldText
		el.selectedIndex = nxidx
	}
}

function moveOptions(src,dest)
{	 
	srclen = src.options.length;
	reslen = dest.options.length + srclen;
	resopt = new Array(reslen);
	destcnt = 1;
	rescnt = 1;
	nbsel = 0;
	resopt[0] = new Option(dest.options[0].text,dest.options[0].value);
	while(destcnt < dest.options.length)
	{
		resopt[rescnt] = new Option(dest.options[destcnt].text,dest.options[destcnt].value);
		destcnt++;
		rescnt++;
	}
	for(i = 1; i < srclen; i++)
	{
		while((i < srclen) && (src.options[i].selected == false))
			i++;
		if(i < srclen)
		{
			if(src.options[i].value != src.options[0].value)
			{
				nbsel++;
				resopt[rescnt] = new Option(src.options[i].text,src.options[i].value);
				src.options[i] = null;
				i--;
				srclen--;
				rescnt++;
			}
		}
	}
	dest.options[0] = null;
	dest.options[0] = resopt[0];
	
	for(i=0; i < nbsel;i++)
	{
		dest.options[i+1] = null;
		dest.options[i+1] = resopt[rescnt - nbsel + i];
	}

	for(i=0; i < rescnt - nbsel - 1; i++)
	{
		dest.options[nbsel + 1 + i] = null;
		dest.options[nbsel + 1 + i] = resopt[i + 1];
	}
}

function selectAll(list)
{
	list.options[0].selected = false;
	for(i=1; i < list.options.length; i++)
	{
		list.options[i].selected = true;
	}
}
//-->
</script>
<form method="post" name="homeform1" action="{ babPhpSelf }">
<input type="hidden" name="tg" value="{ babAddonTarget }/admin">
<input type="hidden" name="idx" value="export">
<table  width="50%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr> 
<td class="BabLoginCadreBackground"> 
<table class="BabLoginMenuBackground" width="100%" border="0" cellspacing="0" cellpadding="5" align="center">
<tr> 
<td align="center" nowrap valign="middle" colspan="2"> 
<select name="listfield1"  size=12 multiple>
<option value="">{ fieldlisttxt }</option>
<!--#in getnextfieldlist --> 
<option value="{ fieldid }">{ fieldval }</option>
<!--#endin getnextfieldlist --> 
</select>
<br>
</td>
</tr>
<tr> 
<td align="center"><a href="Javascript:moveOptions(document.homeform1.listfield1,document.homeform1.elements[3])"><img src="{ babSkinPath }images/Puces/PuceGoHandDown.gif" width="20" height="24" border=0 alt="Down"></a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="Javascript:moveOptions(document.homeform1.elements[3],document.homeform1.listfield1)" ><img src="{ babSkinPath }images/Puces/PuceGoHandTop.gif" width="20" height="24" border=0 alt="Up"></a></td>
<td>&nbsp;</td>
</tr>
<tr valign="middle"> 
<td align="center"> 
<select name="expfields[]"  size=12 multiple>
<option value="">{ listexptxt }</option>
</select>
</td>
<td align="center" ><a href="Javascript:move(true, document.homeform1.elements[3])"><img src="{ babSkinPath }images/Puces/PuceGoTop.gif" width="22" height="18" border=0 alt="{ moveup }"></a> 
<br>
<br>
<a href="Javascript:move(false, document.homeform1.elements[3])"> 
<img src="{ babSkinPath }images/Puces/PuceGoDown.gif" width="22" height="18" border=0 alt="{ movedown }"></a> 
</td>
</tr>
<tr> 
<td align="center" nowrap valign="middle" colspan="2">
<select name="filter">
<option value="-1">{ all }</option>
<!--#in getnextstatus -->
<option value="{ statusid }">{ vstatus }</option>
<!--#endin getnextstatus -->
</select>
</td>
</tr>
<tr valign="middle"> 
<td align="center"> 
<input type="submit" name="Submit" value="{ create }" onClick="Javascript:selectAll(document.homeform1.elements[3]); document.homeform1.submit()">
<br>
<br>
</td>
<td>&nbsp; 
</td>
</tr>
</table>
</td>
</tr>
</table>
</form>
<br>
<!--#end exporttasks -->
