<!--#begin vtypecreate -->
<script language="JavaScript">
<!--
function validateNum(field) {
var valid = ".0123456789"
var ok = "yes";
var temp;
for (var i=0; i<field.value.length; i++) {
temp = "" + field.value.substring(i, i+1);
if (valid.indexOf(temp) == "-1") ok = "no";
}
if (ok == "no") {
var d1;
alert('{ invalidentry1 }');
field.focus();
field.select();
   }
}

function setColor(color)
	{
	document.forms.ntypeform.tcolor.value=color;
	if (color == '') color = 'fff';
	document.getElementById('typeColor').style.backgroundColor = '#'+color;
	}
//-->
</script>
<form name="ntypeform" method="post" action="{ babPhpSelf }">
<input type="hidden" name="tg" value="vacadm">
<input type="hidden" name="idx" value="lvt">
<input type="hidden" name="add" value="{ what }">
<input type="hidden" name="vtid" value="{ vtid }">
<table width="50%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr> 
<td class="BabLoginCadreBackground"> 
<table width="100%" border="0" cellspacing="0" cellpadding="5" align="center">
<tr> 
<td class="BabLoginMenuBackground" width="30%" align="right" nowrap 
valign="middle">{ name }:</td>
<td class="BabLoginMenuBackground" width="70%" valign="middle"> 
<input type="text" name="tname" size="20" maxlength="20" value="{ tnameval }">
</td>
</tr>
<tr> 
<td class="BabLoginMenuBackground" align="right" nowrap valign="middle">{ description }:</td>
<td class="BabLoginMenuBackground" valign="middle"> 
<input type="text" name="description" size="50" maxlength="255" value="{ descriptionval }">
</td>
</tr>
<tr> 
<td class="BabLoginMenuBackground" align="right" nowrap valign="middle">{ quantity }:</td>
<td class="BabLoginMenuBackground" valign="middle"> 
<input type="text" name="quantity" size="6" maxlength="6"  value="{ quantityval }" onBlur="validateNum(this)">
</td>
</tr>
<tr> 
<td class="BabLoginMenuBackground" align="right" nowrap valign="middle">{ balancetxt }:</td>
<td class="BabLoginMenuBackground" valign="middle"> 
<select name="cbalance">
<option value="Y" { yselected }>{ yestxt }</option>
<option value="N" { nselected }>{ notxt }</option>
</select>
</td>
</tr>
<tr> 
<td class="BabLoginMenuBackground" align="right" valign="middle" nowrap><a class="BabSiteAdminListLink" href="javascript: Start('{ selctorurl }', 'ColorWindow', 'width=250,height=200,status=no,resizable=no,top=200,left=200');">{ colortxt }</a>:</td>
<td class="BabLoginMenuBackground" valign="middle">
<div id="typeColor" style="width:30px;height:15px;border:#000 1px solid;background-color:#{ tcolorval };"></div>
<input type="hidden" name="tcolor" value="{ tcolorval }">
</td>
</tr>
<tr> 
<td class="BabLoginMenuBackground">&nbsp;</td>
<td class="BabLoginMenuBackground" valign="middle"> 
<input type="submit" name="Submit" value="{ add }">
<!--#if bdel -->
&nbsp;&nbsp;<input type="submit" name="bdel" value="{ del }">
<!--#endif bdel -->
</td>
</tr>
</table>
</td>
</tr>
</table>
</form>
<!--#end vtypecreate -->





<!--#begin vtypelist -->
<table width="95%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr> 
<td class="BabLoginCadreBackground"> 
<table width="100%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr> 
<td class="BabSiteAdminTitleFontBackground" nowrap valign="middle">{ nametxt }</td>
<td class="BabSiteAdminTitleFontBackground" align="left" nowrap valign="middle">{ descriptiontxt }</td>
<td class="BabSiteAdminTitleFontBackground" align="center" valign="middle">{ quantitytxt }</td>
<td class="BabSiteAdminTitleFontBackground" align="center" valign="middle">{ altaddvr }</td>
<td class="BabSiteAdminTitleFontBackground" align="center" valign="middle">{ colortxt }</td>
</tr>
<!--#in getnext -->
<tr> 
<td class="BabSiteAdminFontBackground" nowrap valign="middle"><a class="BabSiteAdminListLink" href="{ url }">{ urlname }</a></td>
<td class="BabSiteAdminFontBackground" valign="middle">{ description }</td>
<td align="center" valign="middle" class="BabSiteAdminFontBackground">{ quantity }</td>
<td class="BabSiteAdminFontBackground" align="center" valign="middle"><a href="{ addurl }"><img src="{ babSkinPath }images/Puces/PuceRightVacation.gif" alt="{ altaddvr }" border="0" align="middle"></a></td>
<td valign="middle"  bgcolor="#{ tcolor }"><span>&nbsp;</span></td>
<!--#endin getnext -->
</table>
</td>
</tr>
</table>
<br>
<!--#end vtypelist -->


<!--#begin vcollist -->
<table width="80%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr> 
<td class="BabLoginCadreBackground"> 
<table width="100%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr> 
<td class="BabSiteAdminTitleFontBackground" nowrap valign="middle">{ nametxt }</td>
<td class="BabSiteAdminTitleFontBackground" align="left" nowrap valign="middle">{ descriptiontxt }</td>
</tr>
<!--#in getnext -->
<tr> 
<td class="BabSiteAdminFontBackground" nowrap valign="middle"><a class="BabSiteAdminListLink" href="{ url }">{ urlname }</a></td>
<td class="BabSiteAdminFontBackground" valign="middle">{ description }</td>
</tr>
<!--#endin getnext -->
</table>
</td>
</tr>
</table>
<br>
<!--#end vcollist -->

<!--#begin vcolcreate -->
<form method="post" action="{ babPhpSelf }">
<input type="hidden" name="tg" value="vacadm">
<input type="hidden" name="idx" value="lcol">
<input type="hidden" name="add" value="{ what }">
<input type="hidden" name="vcid" value="{ vcid }">
<table width="50%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr> 
<td class="BabLoginCadreBackground"> 
	<table class="BabLoginMenuBackground" width="100%" border="0" cellspacing="0" cellpadding="5" align="center">
	<tr> 
		<td align="right">{ name }:</td>
		<td> 
		<input type="text" name="tname" size="20" maxlength="20" value="{ tnameval }" />
		</td>
	</tr>
	<tr> 
		<td align="right">{ description }:</td>
		<td> 
		<input type="text" name="description" size="50" maxlength="255" value="{ descriptionval }">
		</td>
	</tr>
	<tr> 
		<td align="right">{ vactypes }:</td>
		<td> 
		<!--#in getnext -->
		<br><input type="checkbox" name="vtypeids[]" { vtcheck } value="{ vtid }">&nbsp;&nbsp;{ vtypename }
		<!--#endin getnext -->
		</td>
	</tr>
	<tr> 
		<td>&nbsp;</td>
		<td> 
		<input type="submit" name="Submit" value="{ add }">
		<!--#if bdel -->
		&nbsp;&nbsp;<input type="submit" name="bdel" value="{ del }">
		<!--#endif bdel -->
		</td>
	</tr>
	</table>
</td>
</tr>
</table>
</form>
<!--#end vcolcreate -->


<!--#begin vpersonnellist -->
<form name="listform" method="post" action="{ babPhpSelf }">
<input type="hidden" name="tg" value="vacadm">
<input type="hidden" name="idx" value="lper">
<input type="hidden" name="pos" value="{ pos }">
<table border="0" width="95%" cellpadding="2" cellspacing="0" align="center">
<tr> 
	<td class="BabLoginCadreBackground"> 
	<table  width="100%" border="0" cellspacing="0" cellpadding="2" align="center">
		<tr class="BabSiteAdminTitleFontBackground"> 
			<td colspan="4" class="BabLetterlists" style="white-space:nowrap">
				<!--#if allselected "== 1" -->
				{ allname }&nbsp;
				<!--#else allselected -->
				<a class="BabAlphabetLink" href="{ allurl }">{ allname }</a>&nbsp;
				<!--#endif allselected -->
				<!--#in getnextselect -->
				<!--#if selected "== 1" -->
				{ selectname }&nbsp;
				<!--#else selected -->
				<a class="BabAlphabetLink" href="{ selecturl }">{ selectname }</a>&nbsp;
				<!--#endif selected -->
				<!--#endin getnextselect -->
			</td>
			<td align="right" class="BabLetterlists" colspan="2">
				<a href="{ addpurl }">{ addpersonnel }</a>&nbsp|&nbsp
				<a href="{ addgurl }">{ g_addpersonnel }</a>
			</td>
		</tr>

		<tr class="BabSiteAdminTitleFontBackground">         
			<td width="1%">
				<a href="javascript:onCheckAll('userids', true)"><img src="{ babSkinPath }images/Puces/Pucecheked.gif" alt="{ checkall }" border="0"></a><a href="javascript:onCheckAll('userids', false)"><img src="{ babSkinPath }images/Puces/PuceUncheked.gif" alt="{ uncheckall }" border="0"></a></td>
			<td><a href="{ fullnameurl }">{ fullname }</a></td>
			<td>{ collection }</td>
			<td>{ appschema }</td>
			<td>{ altlrbu }</td>
			<td>{ altcal }</td>
		</tr>
		<!--#in getnext -->
		<tr class="BabSiteAdminFontBackground"> 
			<td width="1%"> 
			<input type="checkbox" name="userids[]" value="{ userid }" />
			</td>
			<td width="20%"><a class="BabNameEmailLink" href="{ url }">{ urlname }</a></td>
			<td>{ collname }</td>
			<td>{ saname }</td>
			<td><a href="{ lrbuurl }" onclick="bab_popup(this.href);return false;"><img src="{ babSkinPath }images/Puces/PuceRightVacation.gif" alt="{ altlrbu }" border="0" align="middle"></a></td>
			<td><a href="{ calurl }&popup=1" onclick="bab_popup(this.href);return false;"><img src="{ babSkinPath }images/Puces/PuceCalendar.gif" alt="{ altcal }" border="0" align="middle"></a></td>
		</tr> 
		<!--#endin getnext -->
		<tr class="BabSiteAdminTitleFontBackground"> 
			<td align="center">
				<a href="javascript:submitForm('delu','listform')"><img src="{ babSkinPath }images/Puces/del.gif" alt="{ deletealt }" border="0"></a>
			</td>
			<td colspan="5">&nbsp;</td>
		</tr>
	</table>
	</td>
</tr>
</table>
</form>
<br />

<form name="filterform" method="post" action="{ babPhpSelf }">
<input type="hidden" name="tg" value="vacadm">
<input type="hidden" name="idx" value="lper">
<input type="hidden" name="pos" value="{ pos }">
  <table border="0" width="95%" cellpadding="2" cellspacing="0" align="center">
    <tr>
      <td class="BabLoginCadreBackground">
		<table border="0" width="100%" cellpadding="5" cellspacing="0" class="BabLoginMenuBackground">
          <tr>
            <td>&nbsp;</td>
            <td>{ collection }</td>
            <td>{ appschema }</td>
          </tr>
          <tr>
            <td><input type="submit" name="submit" value="{ filteron }" /></td>
            <td>
			<select name="idcol">
                <option value=""></option>
                <!--#in getnextcol -->
                <option value="{ idcollection }" { selected }>{ collname }</option>
                <!--#endin getnextcol -->
              </select>
			</td>
            <td>
			<select name="idsa">
                <option value=""></option>
                <!--#in getnextsa -->
                <option value="{ idsapp }" { selected }>{ saname }</option>
                <!--#endin getnextsa -->
              </select>
			</td>
          </tr>
        </table>
	</td>
    </tr>
  </table>
</form>
<!--#end vpersonnellist -->

<!--#begin personnelcreate -->
<script type="text/javascript">
<!--
function onUser(id, fn)
{
document.forms['user'].user.value=fn;
document.forms['user'].userid.value=id;
this.focus();
op.close();
}

var op = null;
function openPopup(url)
{
if( op == null || op.closed )
	op = this.open(url+'onUser', 'babuserslist', 'width=550,height=550,status=no,resizable=yes,top=200,left=200,scrollbars=yes');
else
	op.focus();
}

//-->
</script>

<form name="user" method="post" action="{ babPhpSelf }">
<input type="hidden" name="tg" value="vacadm" />
<input type="hidden" name="idx" value="lper" />
<input type="hidden" name="add" value="changeuser" />
<input type="hidden" name="idp" value="{ idp }" />

<table  width="50%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr> 
<td class="BabLoginCadreBackground" align="center" valign="middle"> 
	<table class="BabLoginMenuBackground" width="100%" border="0" cellspacing="0" cellpadding="5">
		<!--#if idp -->
		<tr> 
			<td  align="right">{ usertext }:</td>
			<td> 
				{ userval }
			</td>
		</tr>
		<!--#else idp -->
		<tr> 
			<td  align="right"><a href="javascript: openPopup('{ usersbrowurl }');">{ usertext }</a>:</td>
			<td> 
				<input type="text" name="user" size="45" maxlength="255" value="{ userval }" disabled="disabled" />
				<input type="hidden" name="userid" value="{ userid }" />
			</td>
		</tr>
		<!--#endif idp -->
		<tr> 
			<td align="right">{ collection }:</td>
			<td> 
				<select name="idcol">
				<!--#in getnextcol -->
				<option value="{ idcollection }" { selected }>{ collname }</option>
				<!--#endin getnextcol -->
				</select>
			</td>
		</tr>
		<tr> 
			<td align="right">{ appschema }:</td>
			<td> 
				<select name="idsa">
				<!--#in getnextsa -->
				<option value="{ idsapp }" { selected }>{ saname }</option>
				<!--#endin getnextsa -->
				</select>
			</td>
		</tr>
		<tr> 
		<td>&nbsp;</td>
		<td> 
		<input type="submit" name="submit" value="{ add }" />
		<br>
		</td>
		</tr>
	</table>
</td>
</tr>
</table>
</form>
<br />
<br />
<!--#end personnelcreate -->

<!--#begin grouppersonnelcreate -->
<script type="text/javascript">
<!--

function onGroup(id, fn)
{
document.forms['group'].group.value=fn;
document.forms['group'].groupid.value=id;
this.focus();
op2.close();
}

var op2 = null;
function openPopupG(url)
{
if( op2 == null || op2.closed )
	op2 = this.open(url+'onGroup', 'babgroupslist', 'width=550,height=550,status=no,resizable=yes,top=200,left=200,scrollbars=yes');
else
	op2.focus();
}

function radiochange(obj)
{
	if (obj.value == 'modify')
		document.forms['group'].idcol.disabled = true;
	else
		document.forms['group'].idcol.disabled = false;
}


//-->
</script>
<form name="group" method="post" action="{ babPhpSelf }">
<input type="hidden" name="tg" value="vacadm" />
<input type="hidden" name="idx" value="lper" />
<input type="hidden" name="add" value="changegroup" />
<table  width="60%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr> 
<td class="BabLoginCadreBackground" align="center" valign="middle"> 
	<table class="BabLoginMenuBackground" width="100%" border="0" cellspacing="0" cellpadding="5">
		<tr> 
			<td align="right"><a href="javascript: openPopupG('{ groupsbrowurl }');">{ grouptext }</a>:</td>
			<td> 
				<input type="text" name="group" size="35" maxlength="255" value="{ groupval }" disabled="disabled" />
				<input type="hidden" name="groupid" value="{ groupid }" />
			</td>
		</tr>
		<tr>
			<td align="right">&nbsp;</td>
			<td> 
				<dl>
					<dt>{ t_add_modify }</dt>
					<dd><input type="radio" name="addmodify" value="add" onclick="radiochange(this)" checked="checked" />{ t_add }</dd>
					<dd><input type="radio" name="addmodify" value="modify" onclick="radiochange(this)" />{ t_modify }<dd>
				</dl>
			</td>
		</tr>
		<tr>
			<td align="right">{ collection }:</td>
			<td> 
				<select name="idcol">
				<!--#in getnextcol -->
				<option value="{ idcollection }" { selected }>{ collname }</option>
				<!--#endin getnextcol -->
				</select>
			</td>
		</tr>
		<tr> 
			<td align="right">{ appschema }:</td>
			<td> 
				<select name="idsa">
				<!--#in getnextsa -->
				<option value="{ idsapp }" { selected }>{ saname }</option>
				<!--#endin getnextsa -->
				</select>
			</td>
		</tr>
		<tr> 
			<td>&nbsp;</td>
			<td> 
				<input type="submit" name="submit" value="{ t_record }" />
			</td>
		</tr>
	</table>
</td>
</tr>
</table>
</form>
<!--#end grouppersonnelcreate -->

<!--#begin changeucol -->
<script type="text/javascript">
<!--

function computeRights(obj,max)
{
	if (ParseInt(obj.value) > max)
		obj.value = max;

	var f = document.forms['changeucol'];
	var prefix = 'right_';

	var sum = 0;

	for (var i = 0 ; i < f.elements.length ; i++ )
		{
		if (f.elements[i].name.substring(0,prefix.length) == prefix)
			{
			if (!isNaN(f.elements[i].value))
				sum += parseInt(f.elements[i].value);
			}
		}
	
	f.days.value = parseInt(f.total.value) - sum;
}



//-->
</script>

<form name="changeucol" method="post" action="{ babPhpSelf }">
<input type="hidden" name="tg" value="vacadm" />
<input type="hidden" name="idx" value="lper" />
<input type="hidden" name="add" value="changeucol" />
<input type="hidden" name="idp" value="{ id_user }" />
<input type="hidden" name="idcol" value="{ id_coll }" />
<table width="60%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr> 
<td class="BabLoginCadreBackground" align="center" valign="middle"> 
	<table class="BabLoginMenuBackground" width="100%" border="0" cellspacing="0" cellpadding="5">
		<tr> 
			<td>&nbsp;</td>
			<td colspan="2"> 
				<h5>{ t_oldcol }</h5>
			</td>
			<td colspan="2"> 
				<h5>{ t_newcol }</h5>
			</td>
		</tr>
		<!--#in getnext -->
		<tr>
			<td>{ right[description] }</td>
			<td>{ right[quantity] }</td>
			<td>{ right[quantitydays] }</td>

			<td>{ right[quantity] }</td>
			<td><input type="text" name="right_{ id }" value="{ newrightvalue }" size="4" maxlength="5" onKeyUp="computeRights()" /></td>

		</tr>
		<!--#endin getnext -->
		<tr> 
			<td colspan="5" align="center"> 
				<input type="submit" name="submit" value="{ t_record }" />
			</td>
		</tr>
	</table>
</td>
</tr>
</table>
</form>
<!--#end changeucol -->

<!--#begin rlistbyuser -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<TITLE>{ babSiteName }</TITLE>
{ babMeta }
{ babCss }
<script type="text/javascript" src="{ babOvidentiaJs }">
<!--
//-->
</script>
<script type="text/javascript">
<!--
window.focus();

function validateNum(field) {
var valid = ".0123456789"
var ok = "yes";
var temp;
for (var i=0; i<field.value.length; i++) {
temp = "" + field.value.substring(i, i+1);
if (valid.indexOf(temp) == "-1") ok = "no";
}
if (ok == "no") {
var d2;
alert("{ invalidentry }");
field.focus();
field.select();
return false;
   }
return true;
}

function validateDayField(field) {
	if( field.value.length > 0 && validateNum(field))
	{
	tp = parseFloat(field.value);
	if( isNaN(tp) )
		alert( '{ invalidentry1 }');

	if( tp % 0.5 != 0 )
		{
		var d1;
		alert( '{ invalidentry2 }' );
		field.focus();
		field.select();
		}
	}
}
//-->
</script>
</HEAD>
<BODY class="BabBackground">
<br>
<form name="rmodify" method="post" action="{ babPhpSelf }">
<input type="hidden" name="tg" value="vacadm">
<input type="hidden" name="idx" value="rlbuul">
<input type="hidden" name="add" value="modrbu">
<input type="hidden" name="iduser" value="{ iduser }">
<table border="0" width="90%" cellpadding="3" cellspacing="0" align="center">
<tr>
<td class="BabSiteAdminFontBackground" align="right" >{ titletxt }</td>
<td class="BabErrorMessage" align="left" >{ fullname }</td>
</tr></table></center>
<br>
<table width="95%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr> 
<td class="BabLoginCadreBackground"> 
<table width="100%" border="0" cellspacing="0" cellpadding="5" align="center">
<tr> 
<td class="BabSiteAdminTitleFontBackground" nowrap valign="middle">{ desctxt }</td>
<td class="BabSiteAdminTitleFontBackground" align="left" nowrap valign="middle">{ quantitytxt }</td>
<td class="BabSiteAdminTitleFontBackground" align="left" nowrap valign="middle">{ consumedtxt }</td>
<td class="BabSiteAdminTitleFontBackground" align="left" valign="middle">{ datetxt }</td>
<td class="BabSiteAdminTitleFontBackground" nowrap valign="middle">{ datebtxt }</td>
<td class="BabSiteAdminTitleFontBackground" align="left" valign="middle">{ dateetxt }</td>
</tr> 
<!--#in getnextright -->
<!--#if bview -->
<tr> 
<td class="BabSiteAdminFontBackground" nowrap valign="middle">{ description }</td>
<td class="BabSiteAdminFontBackground" valign="middle">
<input type="text" name="quantities[]" size="5" maxlength="5" value="{ quantity }" onBlur="validateDayField(this)"></td>
<input type="hidden" name="idrights[]" value="{ idright }">
<td class="BabSiteAdminFontBackground" valign="middle">{ consumed }</td>
<td class="BabSiteAdminFontBackground" valign="middle">{ date }</td>
<td class="BabSiteAdminFontBackground" nowrap valign="middle">{ dateb }</td>
<td class="BabSiteAdminFontBackground" valign="middle">{ datee }</td>
<!--#endif bview -->
<!--#endin getnextright -->
</table>
</td>
</tr>
</table>
<br>
<center><input type="submit" name="submit" value="{ updatetxt }"></center>
</form>
<br>
</BODY>
</HTML>
<!--#end rlistbyuser -->

<!--#begin rlistbyuserunload -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<TITLE>{ sitename }</TITLE>
{ babMeta }
{ babCss }
<script type="text/javascript">
<!--
//-->
</script>

</HEAD>
<BODY>
<br><br><br><br>
<table class="BabLoginMenuBackground" width="50%" border="0" cellspacing="0" cellpadding="2" align="center">
<tr> 
<td> 
<table class="" width="100%" border="0" cellspacing="0" cellpadding="5" align="center">
<tr> 
<td class="BabErrorMessage" colspan="2" align="center">{ message } </td>
</tr>
<tr align="left" valign="middle">
<td class="BabWarningBodyBackground" colspan="2" align="center"><a href="javascript:this.close()">{ 
close }</a> </td>
</tr>
</table>
</td>
</tr>
</table>
<br>

<script type="text/javascript">
	setTimeout("this.close()","1000");
</script>

</BODY>
</HTML>
<!--#end rlistbyuserunload -->